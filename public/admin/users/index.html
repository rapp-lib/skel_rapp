{{assign "page_title" "ユーザー管理"}}
{{inc path="/include/admin_header.html"}}

<h1 class="page-title">{{$page_title}}</h1>

{{form form=$forms.search}}
<table class="tbl detail">
    <tr>
        <th>メール</th>
        <td>{{input name="mail" type="text" class="w-full"}}</td>
    </tr>
</table>
<div class="btn-area clearfix">
    <div class="right clearfix">
        <a href="{{$forms.search->getSearchPageUrl()}}" class="reset-btn">リセット</a>
        <button type="submit" class="search-btn">検索</button>
    </div>
</div>
{{/form}}

<div class="btn-area">
    <div class="right clearfix">
        <a href='{{"admin_users.csv"|page_to_url}}' class="export-btn">CSVダウンロード</a>
    </div>
</div>

{{if count($ts)==0}}

<p>該当する情報がありません</p>

{{else}}{{* 0件ではない場合 *}}

<a id="table-sort" data-sort-base-url='{{$forms.search->getSearchPageUrl(["p"=>0, "sort"=>""])}}' data-sort-current="{{$forms.search.sort}}" data-sort-param-name="sort" data-sort-default="id"></a>
{{script require=["rui.sort"]}}{{/script}}

<table class="tbl list">
    <tr>
        <th>登録日</th>
        <th>メールアドレス</th>
        <th>最終ログイン日時</th>
        <th>代理ログイン</th>
        <th>&nbsp;</th>
    </tr>
    {{foreach $ts as $i => $t}}
    <tr>
        <td>{{$t.reg_date|date:"Y-m-d H:i"}}</td>
        <td>{{$t.mail}}</td>
        <td>{{$t.last_login_date|date:"Y-m-d H:i"}}</td>
        <td></td>
        <td>
            <a href='{{"admin_users.detail"|page_to_url:["id"=>$t.id]}}' class="list-btn">表示</a>
        </td>
    </tr>
    {{/foreach}}
</table>

{{if $p = $ts->getPagerIfHasRecord()}}
<div class="pager">
    <p>全{{$p->get("count")}}件中 {{$p->get("current_volume")}}件を表示</p>
    <ul class="clearfix">
    {{if $p->getPage('prev')}}
        <li class="prev"><a href="{{$forms.search->getSearchPageUrl(['p'=>$p->getPage('prev')])}}">&lt;</a></li>
    {{/if}}
    {{foreach $p->getPages(5) as $page}}
        {{if $page == "last"}}<li>...</li>{{/if}}
        {{if $page == $p->getPage("current")}}<li class="current">{{else}}<li>{{/if}}
        <a href="{{$forms.search->getSearchPageUrl(['p'=>$p->getPage($page)])}}">{{$p->getPage($page)}}</a>
        </li>
        {{if $page == "first"}}<li>...</li>{{/if}}
    {{/foreach}}
    {{if $p->getPage("next")}}
        <li class="next"><a href="{{$forms.search->getSearchPageUrl(['p'=>$p->getPage('next')])}}">&gt;</a></li>
    {{/if}}
    </ul>
</div>
{{/if}}

{{/if}}{{* /0件ではない場合 *}}

<div class="btn-area" style="margin-top: 10px;">
    <a href='{{"admin_index.index"|page_to_url|url:["back"=>1]}}' class="back-btn">戻る</a>
</div>

{{inc path="/include/admin_footer.html"}}
