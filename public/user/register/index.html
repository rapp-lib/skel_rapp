{{assign "page_title" "ユーザー登録"}}
{{inc path="/include/guest_header.html"}}

<h1 class="page-title">{{$page_title}}</h1>

{{if $forms.entry->getErrors()}}
    <p class="errmsg">※入力エラーがあります</p>
{{/if}}
{{script require=["app.observeForm"]}}
    $(function(){
        var state = {{$forms.entry->exportState()|json_encode nofilter}};
        var form = observeForm($("form.form-entry"), state, "admin");
    });
{{/script}}

{{form action='.'|page_to_url enctype="multipart/form-data" method="post" form=$forms.entry class="form-entry"}}
<table class="tbl detail">
    <tr>
        <th>会社名</th>
        <td>{{input name="company_name" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>部署</th>
        <td>{{input name="department" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>役職</th>
        <td>{{input name="position" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>氏名(姓)</th>
        <td>{{input name="last_name" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>氏名(名)</th>
        <td>{{input name="first_name" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>氏名(セイ)</th>
        <td>{{input name="last_name_kana" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>氏名(メイ)</th>
        <td>{{input name="first_name_kana" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>メール</th>
        <td>{{input name="mail" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>メール</th>
        <td>{{input name="mail_confirm" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>郵便番号</th>
        <td>{{input name="zip" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>都道府県</th>
        <td>{{input name="pref" type="select" values=$enum["User.pref"]}}</td>
    </tr>
    <tr>
        <th>市区郡町村</th>
        <td>{{input name="city" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>番地</th>
        <td>{{input name="address" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>建物名</th>
        <td>{{input name="buildings" type="text" class="w-full"}}</td>
    </tr>
    <tr>
        <th>電話番号</th>
        <td>{{input name="tel" type="text" class="w-full" plugins=["split_text"=>["delim"=>"-", "num"=>3]]}}</td>
    </tr>
    <tr>
        <th>FAX番号</th>
        <td>{{input name="fax" type="text" class="w-full" plugins=["split_text"=>["delim"=>"-", "num"=>3]]}}</td>
    </tr>
    <tr>
        <th>パスワード</th>
        <td>{{input name="login_pw" type="password" autocomplete="new-password" class="w-full"}}</td>
    </tr>
    <tr>
        <th>パスワード確認</th>
        <td>{{input name="login_pw_confirm" type="password" autocomplete="new-password" class="w-full"}}</td>
    </tr>
    <tr>
        <th>ユーザー製品</th>
        <td>
            <div class="mi" data-minItems="0" data-maxItems="1000">
                <input type="hidden" name="products"/>
                {{input_fieldset name="products" tmpl="${id}" key="key" assign="fieldset"}}
                    <div class="mi-item" data-itemId="{{$key}}">
                        {{input type="hidden" name="products[$key][ord_seq]" class="mi-item-seq"}}
                        <table class="tbl detail">
                        <tr>
                            <th>製品ID</th>
                            <td class="input-block">{{input name="products[$key][product_id]" type="select" values=$enum["UserProduct.product"]}}</td>
                        </tr>
                        <tr>
                            <th>型名（製造名）</th>
                            <td class="input-block">{{input name="products[$key][model]" type="text" class="w-full"}}</td>
                        </tr>
                        <tr>
                            <th>シリアルNo</th>
                            <td class="input-block">{{input name="products[$key][serial_number]" type="text" class="w-full"}}</td>
                        </tr>
                        <tr>
                            <th>購入元</th>
                            <td class="input-block">{{input name="products[$key][purchase_source]" type="text" class="w-full"}}</td>
                        </tr>
                        <tr>
                            <th>購入理由</th>
                            <td class="input-block">{{input name="products[$key][purchase_reason]" type="textarea"}}</td>
                        </tr>
                        <tr>
                            <th>承認フラグ</th>
                            <td class="input-block">{{input name="products[$key][accept_flg]" type="radioselect" values=$enum["UserProduct.accept_flg"]}}</td>
                        </tr>
                        <tr>
                            <th></th>
                            <td><a href="javascript:void(0);" class="mi-item-remove">削除</a></td>
                        </tr>
                        </table>
                    </div>
                {{/input_fieldset}}
                {{foreach $fieldset.items as $item}}{{$item nofilter}}{{/foreach}}
                <script type="text/template" class="mi-tmpl mi-anchor">{{$fieldset.tmpl nofilter}}</script>
                <a href="javascript:void(0);" class="mi-append">追加</a>
            </div>
            {{script require="rui.mi"}}{{/script}}
        </td>
    </tr>
    <tr>
        <th>備考</th>
        <td>{{input name="memo" type="textarea"}}</td>
    </tr>
    <tr>
        <th>配信</th>
        <td>{{input name="deliv_flg" type="checkbox"}}</td>
    </tr>
</table>
<div class="btn-area">
    <a href='{{"index.index"|page_to_url:["back"=>1]}}' class="back-btn">戻る</a>
    <div class="right clearfix">
        <button type="submit" class="primary-btn">確認</button>
    </div>
</div>
{{/form}}

{{inc path="/include/guest_footer.html"}}
